.PHONY: help install run test docker-build docker-up docker-down docker-logs clean verify

help:  ## æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
	@echo "Weather MCP Server - å¯ç”¨å‘½ä»¤ï¼š"
	@echo ""
	@grep -E '^[a-zA-Z_-]+:.*?## .*$$' $(MAKEFILE_LIST) | awk 'BEGIN {FS = ":.*?## "}; {printf "  \033[36m%-15s\033[0m %s\n", $$1, $$2}'

verify:  ## éªŒè¯ç¯å¢ƒé…ç½®
	@./verify.sh

install:  ## å®‰è£…ä¾èµ–ï¼ˆä½¿ç”¨ UVï¼‰
	@echo "ğŸ“¦ å®‰è£…ä¾èµ–..."
	@uv venv
	@. .venv/bin/activate && uv pip install -e .
	@echo "âœ… ä¾èµ–å®‰è£…å®Œæˆ"

run:  ## è¿è¡ŒæœåŠ¡å™¨
	@echo "ğŸš€ å¯åŠ¨ Weather MCP Server..."
	@python server.py

test:  ## è¿è¡Œæµ‹è¯•
	@echo "ğŸ§ª è¿è¡Œæµ‹è¯•..."
	@python test_server.py

docker-build:  ## æ„å»º Docker é•œåƒ
	@echo "ğŸ³ æ„å»º Docker é•œåƒ..."
	@docker build -t weather-mcp-server .

docker-up:  ## å¯åŠ¨ Docker å®¹å™¨
	@echo "ğŸ³ å¯åŠ¨ Docker å®¹å™¨..."
	@docker-compose up -d
	@echo "âœ… å®¹å™¨å·²å¯åŠ¨"
	@echo "ğŸ“ æŸ¥çœ‹æ—¥å¿—: make docker-logs"

docker-down:  ## åœæ­¢ Docker å®¹å™¨
	@echo "ğŸ›‘ åœæ­¢ Docker å®¹å™¨..."
	@docker-compose down

docker-logs:  ## æŸ¥çœ‹ Docker æ—¥å¿—
	@docker-compose logs -f

clean:  ## æ¸…ç†ä¸´æ—¶æ–‡ä»¶
	@echo "ğŸ§¹ æ¸…ç†ä¸´æ—¶æ–‡ä»¶..."
	@rm -rf __pycache__
	@rm -rf .pytest_cache
	@rm -rf *.egg-info
	@rm -rf .venv
	@rm -rf logs/*.log
	@echo "âœ… æ¸…ç†å®Œæˆ"

dev:  ## å¼€å‘æ¨¡å¼ï¼ˆè‡ªåŠ¨é‡å¯ï¼‰
	@echo "ğŸ”§ å¼€å‘æ¨¡å¼å¯åŠ¨..."
	@uvicorn server:mcp --reload --host 0.0.0.0 --port 8000

